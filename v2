-- Egg Finder and Hatcher (Delta compatible with automatic egg search and opening)

local Players = game:GetService("Players")
local TeleportService = game:GetService("TeleportService")
local LocalPlayer = Players.LocalPlayer
local HttpService = game:GetService("HttpService")
local PlaceId = game.PlaceId

-- Configuration Variables
local egg_amount = "max" -- Number of eggs to hatch at once (set to "max" for max eggs)
local egg_priority = "aura-egg" -- Priority egg (e.g., "aura-egg", "event-1", etc.)
local open_eggs = true -- Set to true to hatch eggs, false to just find them
local target_eggs = {"aura-egg", "event-1", "event-2", "rainbow-egg", "nightmare-egg", "void-egg", "event-3"}

-- Initialize selected egg
local selectedEgg = "aura-egg"  -- Default to "aura-egg" if no selection made yet

-- Fly to the egg and start opening it
function flyToEgg(egg)
    local root = LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
    if root then
        -- Fly to the egg
        local eggPosition = egg.CFrame.Position
        local direction = (eggPosition - root.Position).unit
        while (root.Position - eggPosition).Magnitude > 5 do
            root.CFrame = root.CFrame + direction * 10
            wait(0.1)  -- Minimal delay to simulate flying
        end
        -- Once at the egg, open it
        openEgg(egg)
    end
end

-- Function to hatch the egg (if open_eggs is true)
function openEgg(egg)
    if open_eggs then
        print("Opening egg:", egg.Name)
        
        -- Trigger egg opening action (replace with actual event)
        local eggOpenEvent = game.ReplicatedStorage:FindFirstChild("EggOpenEvent")
        
        if eggOpenEvent then
            -- Fire the event to open the egg (you might need to send additional parameters)
            eggOpenEvent:FireServer(egg)
        else
            print("EggOpenEvent not found!")
        end
    else
        print("Egg found but not opening:", egg.Name)
    end
end

-- Server hop function
local checked = {}
function hop()
    local cursor = ""
    while true do
        local url = ("https://games.roblox.com/v1/games/%s/servers/Public?limit=100&cursor=%s&sortOrder=Asc"):format(PlaceId, cursor)
        local data = HttpService:JSONDecode(game:HttpGet(url))
        for _, s in ipairs(data.data) do
            if not checked[s.id] and s.playing < s.maxPlayers and s.id ~= game.JobId then
                checked[s.id] = true
                TeleportService:TeleportToPlaceInstance(PlaceId, s.id, LocalPlayer)
                return
            end
        end
        if not data.nextPageCursor then break end
        cursor = data.nextPageCursor
    end
end

-- Main loop (find egg, teleport, server hop, hatch eggs)
spawn(function()
    while true do
        -- Search for eggs on the islands (target_eggs list)
        local foundEggs = {}
        for _, eggName in ipairs(target_eggs) do
            local egg = workspace:FindFirstChild(eggName)
            if egg then
                table.insert(foundEggs, egg)
            end
        end

        -- If no eggs are found, hop to another server
        if #foundEggs == 0 then
            print("No desired eggs found in the current server. Hopping to another server...")
            hop() -- Perform server hop
        else
            -- Fly to the egg (prioritize eggs in the target_eggs list)
            local eggToOpen = foundEggs[1] -- Default to the first egg found
            if egg_priority then
                -- If egg_priority is set, prioritize that egg
                for _, egg in ipairs(foundEggs) do
                    if egg.Name == egg_priority then
                        eggToOpen = egg
                        break
                    end
            end
            -- Fly to the selected egg and open it
            flyToEgg(eggToOpen)
        end
        
        wait(5) -- Delay of 5 seconds between searches to allow eggs to appear or the server to stabilize
    end
end)
